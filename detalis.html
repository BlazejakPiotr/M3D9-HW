<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <style>
      .bg {
        width: 100px;
        height: 100px;
        background-color: red;
      }
    </style>
    <title>CRUD - New Amazon - Stive School Homework</title>
  </head>
  <body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="#"></a>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarNav"
        aria-controls="navbarNav"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item active">
            <a class="nav-link" href="index.html">GET Data</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="update.html">POST Data</a>
          </li>
        </ul>
      </div>
    </nav>
    <!-- END NAVBAR -->
    <!-- CONTENT CONTAINER -->
    <div class="container mt-5">
      <div class="row">
        <!-- DISPLAY API DATA -->
        <button class="btn-primary" onclick="editProductData()">
          Edit Product
        </button>
        <!-- END DISPLAY API DATA -->
      </div>
    </div>
    <!-- END CONTENT CONTAINER -->
    <!-- BOOTSTRAP SCRIPTS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <!-- END BOOSTRAP SCRIPTS -->
    <!-- APP SCRIPTS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <script>
      const productId = new URLSearchParams(window.location.search).get("id");
      const row = document.querySelector(".row");

      const recivedData = async () => {
        let response = await fetch(
          "https://striveschool-api.herokuapp.com/api/product/" + productId,
          {
            headers: {
              Authorization:
                "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MTFjZjYyZjJkNTI2MjAwMTViNmRjOTUiLCJpYXQiOjE2MjkyODc5ODMsImV4cCI6MTYzMDQ5NzU4M30.nNXVsU3Xm3rtBjwRiDZJUn8LcZawq-ItVaCq0cX5GZs",
            },
          }
        );
        let data = await response.json();
        displayProduct(data);
      };

      const displayProduct = (product) => {
        let productTitle = document.createElement("h1");
        productTitle.innerText = product.name;
        row.appendChild(productTitle);
        let productDesc = document.createElement("p");
        productDesc.innerText = product.description;
        row.appendChild(productDesc);
        let productImg = document.createElement("img");
        productImg.src = product.imageUrl;
        row.appendChild(productImg);
        let productPrice = document.createElement("p");
        productPrice.innerText = "Price: " + product.price + "$";
        row.appendChild(productPrice);
        let editBtn = document.createElement("button");
        editBtn.classList.add("btn-primary", "my-3");
        editBtn.setAttribute(addEventListener, click);
        editBtn.innerText = "Edit";
        row.appendChild(editBtn);
      };

      window.onload = () => {
        recivedData();
      };

      const editProductData = () => {
        window.location.assign("update.html?id=" + productId);
      };
    </script>
  </body>
</html>
